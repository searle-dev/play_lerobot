# 底盘控制使用说明

## 🎮 控制方式

底盘控制现在支持**直觉式的按键控制**：

### ✅ 新的控制逻辑

```
按下 → 开始运动
长按 → 持续运动  
松开 → 立即停止 🎯
```

## ⌨️ 底盘按键映射

```
        前进
         I
         ↑
         
左转 U       右转 O
    ←   •   →
    
左移 J  ↓  右移 L
       后退
        K
```

### 详细说明

| 按键 | 功能 | 说明 |
|-----|------|------|
| `I` | 前进 | 沿 x 轴正方向移动 |
| `K` | 后退 | 沿 x 轴负方向移动 |
| `J` | 左移 | 沿 y 轴正方向移动 |
| `L` | 右移 | 沿 y 轴负方向移动 |
| `U` | 左转 | 逆时针旋转 |
| `O` | 右转 | 顺时针旋转 |

## 📖 使用示例

### 例子 1：直线前进

```
1. 按住 I 键
   → 机器人开始前进
   
2. 保持按住 3 秒
   → 机器人持续前进 3 秒
   
3. 松开 I 键
   → 机器人立即停止 ✅
```

### 例子 2：精确定位

```
1. 短按 I 键（快速按下并松开）
   → 机器人短暂前进（< 0.5 秒）
   → 自动停止
   
2. 观察位置
   
3. 如需微调，再次短按
   → 又前进一小段
   → 自动停止
```

### 例子 3：改变方向

```
1. 按住 I 键（前进）
   → 机器人前进
   
2. 松开 I 键
   → 机器人停止 ✅
   
3. 按住 K 键（后退）
   → 机器人后退
   
4. 松开 K 键
   → 机器人停止 ✅
```

### 例子 4：原地旋转

```
1. 按住 U 键（左转）
   → 机器人原地逆时针旋转
   
2. 旋转到目标角度
   
3. 松开 U 键
   → 机器人停止旋转 ✅
```

### 例子 5：斜向移动

```
注意：当前实现中，松开任一底盘键都会停止
      如需真正的组合控制，请查看 BASE_CONTROL_FIX.md 的改进建议

1. 按住 I 键（前进）
   → 机器人前进
   
2. 同时按住 J 键（左移）
   → 机器人会响应最后的命令
   
3. 松开任一键
   → 机器人停止
```

## 💡 控制技巧

### 技巧 1：精确控制

**短按多次** > 长按一次

```
✅ 推荐：短按 → 观察 → 短按 → 观察
❌ 不推荐：长按很久，可能会超过目标位置
```

### 技巧 2：平滑移动

**中等时长的按键**

```
太短（< 0.2秒）：移动距离很小
适中（0.5-2秒）：平滑可控 ✅
太长（> 5秒）：可能撞到障碍物 ⚠️
```

### 技巧 3：安全操作

**始终保持松开能停止的意识**

```
✅ 手指悬停在按键上方
✅ 随时准备松开
✅ 视线不离机器人
```

## 🎯 实际场景

### 场景 1：接近物体

```
目标：将机器人移动到桌子旁边

步骤：
1. 按住 I 键，快速接近
2. 距离 1m 时松开
3. 短按 I 键 2-3 次，精确调整
4. 到达目标位置
```

### 场景 2：避开障碍

```
场景：前方有障碍物，需要绕过

步骤：
1. 按住 U 键，左转 45°
2. 松开 U 键停止旋转
3. 按住 I 键前进
4. 松开 I 键
5. 按住 O 键，右转 45°
6. 松开 O 键
7. 继续前进
```

### 场景 3：定点停靠

```
目标：将机器人停在充电桩位置

步骤：
1. 粗定位：长按 I 键接近
2. 松开，观察偏差
3. 旋转调整：短按 U 或 O
4. 精细前进：短按 I 键多次
5. 左右微调：短按 J 或 L
6. 到达精确位置
```

## ⚙️ 技术说明

### 速度设置

底盘有三档速度（通过 N/M 键切换）：

| 档位 | xy 速度 | 旋转速度 | 适用场景 |
|-----|---------|---------|---------|
| 慢速 | 0.1 m/s | 30°/s | 精确操作 |
| 正常 | 0.25 m/s | 60°/s | 日常移动 ✅ |
| 快速 | 0.4 m/s | 90°/s | 快速转移 |

### 响应延迟

```
按键按下 → WebSocket 传输 → 后端处理 → 机器人响应
   ↓            ↓              ↓            ↓
  < 1ms        5-20ms         1-2ms       10-50ms
  
总延迟: 约 20-80ms（人眼难以察觉）
```

### 停止延迟

```
按键松开 → WebSocket 传输 → 速度设为0 → 机器人停止
   ↓            ↓              ↓            ↓
  < 1ms        5-20ms         1-2ms       物理惯性
  
软件延迟: < 30ms
物理惯性: 50-200ms（取决于当前速度）
```

## ⚠️ 注意事项

### 安全第一

1. **始终保持视线接触**
   - 不要在看不见机器人时操作
   
2. **了解停止延迟**
   - 机器人不会瞬间停止
   - 预留安全距离
   
3. **清理工作区域**
   - 移除障碍物
   - 确保有足够空间

### 环境限制

1. **地面平整度**
   - 平整地面：控制精确 ✅
   - 不平地面：可能偏移 ⚠️
   
2. **电池电量**
   - 充足：响应正常
   - 不足：可能变慢或停止
   
3. **无线信号**
   - 强信号：延迟低 ✅
   - 弱信号：可能卡顿 ⚠️

### 操作建议

1. **新手练习**
   ```
   第一步：空旷区域练习前进/后退
   第二步：练习旋转控制
   第三步：练习精确定位
   第四步：组合动作
   ```

2. **熟练之后**
   - 可以尝试更长时间的按键
   - 可以尝试更快的速度档位
   - 可以尝试复杂的路径规划

## 🐛 故障排查

### 问题 1：按键无响应

**可能原因**：
- WebSocket 连接断开
- 机器人未连接

**解决方法**：
1. 检查页面右上角连接状态
2. 刷新页面重新连接
3. 检查后端服务是否运行

### 问题 2：松开后还在动

**可能原因**：
- 物理惯性（正常）
- 代码版本过旧

**解决方法**：
1. 如果只是短暂滑行（< 0.5秒）：正常
2. 如果持续运动：确认已更新到最新版本
3. 重启前端和后端服务

### 问题 3：动作延迟大

**可能原因**：
- 网络延迟
- 系统负载高

**解决方法**：
1. 检查网络连接质量
2. 关闭其他占用带宽的程序
3. 降低相机帧率

### 问题 4：停不下来（紧急情况）

**紧急停止方法**：
1. 快速按下任意底盘键再松开
2. 刷新浏览器页面（WebSocket 断开会触发后端 watchdog）
3. 物理方法：按机器人急停按钮（如有）

## 📝 版本信息

- **实现日期**：2026-01-02
- **功能状态**：✅ 已实现并测试
- **参考文档**：`BASE_CONTROL_FIX.md`

## 🔗 相关文档

- `BASE_CONTROL_FIX.md` - 技术实现细节
- `STATUS.md` - 项目状态总览
- `README.md` - 项目介绍
- `SMOOTH_CONTROL_FIX.md` - 机械臂平滑控制优化

---

**祝遥操作愉快！** 🎮🤖

