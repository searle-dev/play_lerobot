# 🚀 快速开始指南

5 分钟上手 XLerobot Web 遥操作系统！

## 📋 前置检查

在开始之前，请确保：

- [ ] Python 3.8+ 已安装
- [ ] Node.js 16+ 已安装
- [ ] XLerobot 机械臂小车硬件就绪
- [ ] USB 连接线就绪
- [ ] （可选）Xbox 手柄

## ⚡ 一键启动

### 方式 1: 使用 Conda 环境（推荐）⭐

如果您已经配置了 `lerobot` conda 环境：

```bash
cd play_on_web
./start_conda.sh
```

**优点**:
- ✅ 复用 lerobot 环境，无需重复安装
- ✅ 依赖版本一致
- ✅ 启动更快

详细配置请查看 [SETUP_CONDA.md](SETUP_CONDA.md)

### 方式 2: 使用独立虚拟环境

```bash
cd play_on_web
chmod +x start.sh
./start.sh
```

启动脚本会自动：
1. 检查依赖
2. 安装必要的包
3. 启动后端和前端服务

### 方式 3: 手动启动

#### 使用 Conda（推荐）
```bash
# 终端 1 - 后端
conda activate lerobot
cd play_on_web/backend
pip install -r requirements.txt
python main.py

# 终端 2 - 前端
cd play_on_web/frontend
npm install
npm run dev
```

#### 使用 Venv
```bash
# 终端 1 - 后端
cd play_on_web/backend
python -m venv venv
source venv/bin/activate
pip install -r requirements.txt
python main.py

# 终端 2 - 前端
cd play_on_web/frontend
npm install
npm run dev
```

## 🎯 使用步骤

### 1️⃣ 访问 Web 界面

打开浏览器访问: `http://localhost:3000`

### 2️⃣ 配置串口

**自动检测（推荐）:**
1. 点击"自动检测"
2. 拔出 USB 线
3. 点击"完成检测"
4. 重新插入 USB 线

**手动选择:**
1. 从下拉菜单选择串口 1
2. 从下拉菜单选择串口 2
3. 点击"连接机器人"

### 3️⃣ 配置相机（可选）

如果您有相机设备：
1. 为左手腕、右手腕、头部选择相机
2. 系统会自动检测可用相机
3. 点击"继续"

没有相机？直接点击"继续"跳过。

### 4️⃣ 校准

点击"开始遥操作"，系统会：
1. 将机器人移动到安全的初始位置
2. 进入遥操作界面

### 5️⃣ 开始遥操作！

**键盘控制:**
- 左臂: Q/E/R/F/T/G/W/S/A/D/Z/X
- 右臂: 7/9///\*/+/-/8/2/4/6/1/3
- 底盘: I/K/J/L/U/O
- 归零: C (左臂) / 0 (右臂)

**Xbox 手柄:**
1. 连接手柄
2. 切换到"Xbox"模式
3. 使用摇杆和按钮控制

## 🎮 控制技巧

### 键盘控制
- **按住按键**持续控制
- 同时按多个键实现复合动作
- 使用归零键快速回到安全位置

### Xbox 手柄
- **左摇杆**: 控制左臂 XY 位置
- **右摇杆**: 控制右臂 XY 位置
- **扳机**: 控制夹爪开合
- **D-Pad**: 控制底盘移动
- **LB/RB**: 配合摇杆控制俯仰和旋转

## 📹 视频查看

如果配置了相机：
- **网格视图**: 点击"全部"标签
- **单机位**: 点击对应的相机标签
- 视频实时传输，延迟低于 100ms

## 📊 状态监控

右侧状态面板显示：
- 左臂关节角度
- 右臂关节角度
- 头部电机位置
- 实时更新频率: 10 Hz

## ⚠️ 安全提示

1. **首次使用前**
   - 确保机器人周围有足够空间
   - 了解紧急停止方法
   - 从小幅度动作开始

2. **操作过程中**
   - 注意观察机器人运动范围
   - 避免突然的大幅度动作
   - 定期使用归零功能

3. **异常情况**
   - 发现异常立即按归零或断开连接
   - 检查 USB 连接
   - 查看终端日志

## 🐛 常见问题

### Q: 无法连接机器人？
**A:** 检查：
1. USB 线是否连接
2. 机器人是否通电
3. 串口选择是否正确
4. 查看后端终端日志

### Q: 相机无法显示？
**A:** 尝试：
1. 刷新页面
2. 检查相机权限
3. 重新配置相机
4. 查看浏览器控制台

### Q: 键盘控制无响应？
**A:** 确保：
1. 浏览器窗口有焦点
2. WebSocket 已连接（查看右上角状态）
3. 没有其他程序占用键盘

### Q: Xbox 手柄不工作？
**A:** 检查：
1. 手柄已连接（有线或无线）
2. 按任意键激活手柄
3. 使用 Chrome 或 Edge 浏览器
4. 查看控制面板的连接状态

## 📚 进阶使用

### 调整控制参数

编辑 `backend/robot_controller.py`:
```python
# 修改步进大小
degree_step: float = 3.0  # 角度步进
xy_step: float = 0.0081    # XY 步进

# 修改 P 控制增益
kp: float = 0.81           # P 控制器增益
```

### 查看 API 文档

访问 `http://localhost:8000/docs` 查看完整 API 文档。

### 自定义键位映射

编辑 `frontend/src/components/KeyboardControl.tsx` 中的键位映射。

## 🎓 学习资源

- **项目文档**: 查看 `README.md` 了解详细信息
- **API 文档**: `http://localhost:8000/docs`
- **示例代码**: 参考 `lerobot/examples/xlerobot/`
- **Lerobot 文档**: https://github.com/huggingface/lerobot

## 💡 最佳实践

1. **初次使用**
   - 先熟悉键盘控制
   - 从单臂控制开始
   - 逐步增加动作复杂度

2. **日常使用**
   - 定期校准归零
   - 保持软件更新
   - 备份重要配置

3. **性能优化**
   - 关闭不需要的相机
   - 降低视频质量以提高流畅度
   - 使用有线网络连接

## 🆘 需要帮助？

- **查看日志**: 后端和前端终端都有详细日志
- **检查连接**: 右上角显示连接状态
- **重启服务**: Ctrl+C 停止，然后重新启动
- **重置配置**: 返回设备配置重新设置

---

**准备好了吗？开始您的 XLerobot 遥操作之旅！** 🚀🤖

按照以上步骤，您应该能在 5 分钟内完成设置并开始控制机器人。

如遇问题，请查看完整文档 `README.md` 或检查终端日志输出。

